## 상황
- 워커 노드 생성에 실패하는 상황
<img width="1408" alt="image" src="https://github.com/bong6981/kube-study/assets/103120173/1688fdff-7af5-4d2f-9a78-72c0a8d0d6f8">

### `NodeCreationFailure`
- [참고링크](https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/troubleshooting.html)
시작된 인스턴스를 Amazon EKS 클러스터에 등록할 수 없습니다. 이러한 오류의 일반적인 원인은 [노드 IAM 역할 권한](https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/create-node-role.html)이 충분하지 않거나 노드에 대한 아웃바운드 인터넷 액세스가 부족하기 때문입니다. 노드는 다음 요구 사항 중 하나를 충족해야 합니다.
- 퍼블릭 IP 주소를 사용하여 인터넷에 액세스할 수 있습니다. 노드가 있는 서브넷에 연결된 보안 그룹은 통신을 허용해야 합니다. 자세한 내용은 서브넷 요구 사항 및 고려 사항 및 Amazon EKS 보안 그룹 요구 사항 및 고려 사항 단원을 참조하세요.
- 노드와 VPC는 프라이빗 클러스터 요구 사항의 요구 사항을 충족해야 합니다.


## 해결
- 임시해결로 노드 생성 role에 AmazonEKS_CNI_Policy 권한을 추가하였습니다.
- 그러나 이 역할에 정책을 연결하는 대신 Amazon VPC CNI 추가 기능에 특별히 사용되는 별도의 역할에 정책을 연결하는 것이 좋습니다.
  - Amazon VPC CNI 추가 기능에 대한 별도의 역할 생성에 대한 자세한 내용은 서비스 계정용 IAM 역할(IRSA)을 사용하도록 Amazon VPC CNI plugin for Kubernetes 구성 섹션을 참조 [link](https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-iam-role.html)
<img width="1408" alt="image" src="https://github.com/bong6981/kube-study/assets/103120173/8036e969-e1ff-4c8d-b0fc-425346dc6503">
